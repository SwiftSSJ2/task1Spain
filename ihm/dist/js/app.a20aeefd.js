(function(){"use strict";var e={1025:function(e,t,r){var o=r(9242),s=r(3396);const a={id:"app"};function i(e,t,r,o,i,n){const l=(0,s.up)("Menu"),u=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",a,[i.showMenu?((0,s.wg)(),(0,s.j4)(l,{key:0})):(0,s.kq)("",!0),(0,s.Wm)(u)])}function n(e,t,r,o,a,i){const n=(0,s.up)("el-menu-item"),l=(0,s.up)("el-button"),u=(0,s.up)("el-menu");return(0,s.wg)(),(0,s.j4)(u,{class:"el-menu-demo",mode:"horizontal",style:{"background-color":"rgb(0, 117, 137)","justify-content":"center"}},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{index:"1",style:{"font-size":"large"},onClick:t[0]||(t[0]=e=>i.navigate("listeRdv"))},{default:(0,s.w5)((()=>[(0,s.Uk)("Appointment list")])),_:1}),(0,s.Wm)(n,{index:"2",style:{"font-size":"large"},onClick:t[1]||(t[1]=e=>i.navigate("ajouter"))},{default:(0,s.w5)((()=>[(0,s.Uk)("Add appointment")])),_:1}),(0,s.Wm)(n,{index:"3",style:{"font-size":"large","margin-left":"auto"}},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{type:"primary",onClick:i.logout},{default:(0,s.w5)((()=>[(0,s.Uk)("Log Out")])),_:1},8,["onClick"])])),_:1})])),_:1})}r(560);var l={methods:{navigate(e){this.$router.push(`/${e}`)},logout(){localStorage.removeItem("auth"),this.$router.push("/login")}}},u=r(89);const d=(0,u.Z)(l,[["render",n],["__scopeId","data-v-2f34c6d6"]]);var m=d,c={components:{Menu:m},data(){return{showMenu:!0}},watch:{$route(e){this.showMenu=!("/login"===e.path||"/register"===e.path)}}};const p=(0,u.Z)(c,[["render",i]]);var h=p,f=r(3852),g=r(6709),w=r(701),v=r(2483);const y=e=>((0,s.dD)("data-v-71dcfac0"),e=e(),(0,s.Cn)(),e),b=y((()=>(0,s._)("div",{style:{"margin-top":"2%","font-size":"5vh"}}," Fill the information to get your appointment! ",-1))),$={key:0,slot:"error",class:"error-message",style:{color:"red"}},x={key:0,slot:"error",class:"error-message",style:{color:"red"}},D=y((()=>(0,s._)("span",{class:"text-gray-500"},"-",-1))),T={key:0,slot:"error",class:"error-message",style:{color:"red"}},_={key:0,slot:"error",class:"error-message",style:{color:"red"}},k={key:0,slot:"error",class:"error-message",style:{color:"red"}};function R(e,t,r,o,a,i){const n=(0,s.up)("el-input"),l=(0,s.up)("el-form-item"),u=(0,s.up)("el-date-picker"),d=(0,s.up)("el-col"),m=(0,s.up)("el-time-picker"),c=(0,s.up)("el-button"),p=(0,s.up)("el-form");return(0,s.wg)(),(0,s.iD)(s.HY,null,[b,(0,s._)("div",null,[(0,s.Wm)(p,{ref:"form",model:a.form,"label-width":"120px",style:{"margin-top":"4%","margin-left":"2%","margin-right":"2%"},"label-position":"top"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{label:"Title"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:a.form.titre,"onUpdate:modelValue":t[0]||(t[0]=e=>a.form.titre=e),placeholder:"Subject of your appointment"},null,8,["modelValue"]),a.submitForm&&!a.form.titre?((0,s.wg)(),(0,s.iD)("div",$,"the field is required.")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(l,{label:"Date and time"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{span:11},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{modelValue:a.form.date,"onUpdate:modelValue":t[1]||(t[1]=e=>a.form.date=e),type:"date",placeholder:"Pick a date",style:{width:"100%"},format:"DD/MM/YYYY"},null,8,["modelValue"]),a.submitForm&&!a.form.date?((0,s.wg)(),(0,s.iD)("div",x,"the field is required.")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(d,{span:2,class:"text-center"},{default:(0,s.w5)((()=>[D])),_:1}),(0,s.Wm)(d,{span:11},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{modelValue:a.form.heure,"onUpdate:modelValue":t[2]||(t[2]=e=>a.form.heure=e),type:"hour",placeholder:"Choose the time",style:{width:"100%"}},null,8,["modelValue"]),a.submitForm&&!a.form.heure?((0,s.wg)(),(0,s.iD)("div",T,"the field is required.")):(0,s.kq)("",!0)])),_:1})])),_:1}),(0,s.Wm)(l,{label:"Addresse"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:a.form.adresse,"onUpdate:modelValue":t[3]||(t[3]=e=>a.form.adresse=e),placeholder:"Addresse of your appointment"},null,8,["modelValue"]),a.submitForm&&!a.form.adresse?((0,s.wg)(),(0,s.iD)("div",_,"the field is required.")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(l,{label:"Description"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:a.form.motif,"onUpdate:modelValue":t[4]||(t[4]=e=>a.form.motif=e),type:"textarea",placeholder:"Description of your appointment"},null,8,["modelValue"]),a.submitForm&&!a.form.motif?((0,s.wg)(),(0,s.iD)("div",k,"the field is required.")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{disabled:a.btnDisabled,type:"primary",onClick:i.onSubmit},{default:(0,s.w5)((()=>[(0,s.Uk)("Save")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1},8,["model"])])],64)}var C=r(4161);const W="https://apichoisistonrdv.fr";class I{constructor(){this.client=C.Z.create({baseURL:W,timeout:5e3})}async getAllRdv(e){try{const t=await this.client.get(`api/getAllRdv/${e}`);return t.data}catch(t){throw new Error(`Erreur lors de la récupération des posts : ${t}`)}}async checkUser(e){try{const t=await this.client.get(`api/checkUser/${e}`),r=t.data.map((e=>e))[0];return r}catch(t){throw new Error(`Il n'y a pas de user associé a ce login : ${t}`)}}async addRdv(e){try{const t=await this.client.post("api/addRdv",e);return t.data}catch(t){throw new Error(`Erreur lors de l'enregistrement du rdv': ${t}`)}}async getRdvById(e){try{const t=await this.client.get(`api/getRdvById/${e}`);return t.data}catch(t){throw new Error(`Erreur lors de la récupération du rdv': ${t}`)}}async updateRdvById(e,t){console.log(e);try{const r=await this.client.put(`api/updateRdvById/${t}`,e);return r.data}catch(r){throw new Error(`Erreur lors de la modification du rdv': ${r}`)}}async deleteLine(e){try{const t=await this.client.delete(`api/delete/${e}`);return t.data}catch(t){throw new Error(`Erreur lors de la suppression du rdv': ${t}`)}}async register(e){try{const t=await this.client.post("api/createUser",e);return t.data}catch(t){throw new Error(`Erreur lors de l'ajout du User': ${t}`)}}}var V=I,U={data(){return{form:{titre:"",date:"",heure:"",adresse:"",motif:""},submitForm:!1,btnDisabled:!1}},async created(){this.rdvServices=new V},async mounted(){if(this.$route.params.id){const e=await this.rdvServices.getRdvById(this.$route.params.id);e&&(this.form.titre=e[0].titre||"",this.form.date=e[0].daterdv||"",this.form.heure=e[0].heurerdv||"",this.form.adresse=e[0].adresse||"",this.form.motif=e[0].motif||"")}},methods:{async edit(){this.btnDisabled=!0,await new Promise((e=>setTimeout(e,2e3)));const e=new Date(this.form.date);this.form.date=e,this.$confirm("Voulez-vous vraiment modifier cet élément?","Confirmation",{confirmButtonText:"Confirmer",cancelButtonText:"Annuler",type:"warning"}).then((async()=>{await this.rdvServices.updateRdvById(this.form,this.$route.params.id).then((()=>{this.$message({message:"Modification terminé !",type:"success",duration:3e3,showClose:!0}),this.$router.push("/")})).catch((e=>{this.$message({message:"Erreur lors de la modification du rendez-vous !",type:"warning",duration:3e3,showClose:!0}),console.error(e)}))})),this.btnDisabled=!1},returnMenu(){this.$router.push("/")},checkInput(){return!!(this.form.titre&&this.form.heure&&this.form.date&&this.form.adresse&&this.form.motif)},pad(e){return e<10?"0"+e:e},async onSubmit(){const e=this.form.heure,t=e.getHours(),r=e.getMinutes(),o=e.getSeconds(),s=`${this.pad(t)}:${this.pad(r)}:${this.pad(o)}`,[a,i,n]=s.split(":"),l=`${a}${i}${n}Z`;if(this.btnDisabled=!0,await new Promise((e=>setTimeout(e,2e3))),this.submitForm=!0,this.user=JSON.parse(localStorage.getItem("auth")),this.checkInput()){const e={titre:this.form.titre,date:new Date(this.form.date),heure:l,adresse:this.form.adresse,motif:this.form.motif,idUser:this.user.id};this.rdvServices.addRdv(e).then((()=>{this.$message({message:"Enregistement effectué !",type:"success",duration:3e3,showClose:!0}),this.$router.push("/")})).catch((e=>{this.$message({message:"Erreur lors de l'enregistrement du rendez-vous !",type:"warning",duration:3e3,showClose:!0}),console.error(e)}))}else this.$message({message:"Tous les champs ne sont pas remplis !",type:"warning",duration:3e3,showClose:!0});await new Promise((e=>setTimeout(e,2e3))),this.btnDisabled=!1}}};const S=(0,u.Z)(U,[["render",R],["__scopeId","data-v-71dcfac0"]]);var E=S;const F=e=>((0,s.dD)("data-v-1266ca7f"),e=e(),(0,s.Cn)(),e),A=F((()=>(0,s._)("div",{style:{"margin-top":"2%","font-size":"5vh"}}," List of all your appointment! ",-1))),P=F((()=>(0,s._)("i",{class:"el-icon-plus"},null,-1)));function M(e,t,r,o,a,i){const n=(0,s.up)("el-table-column"),l=(0,s.up)("el-button"),u=(0,s.up)("el-table");return(0,s.wg)(),(0,s.iD)(s.HY,null,[A,(0,s.Wm)(u,{data:a.allRdv,stripe:"",style:{width:"100%","margin-top":"3%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{label:"Date",prop:"date"}),(0,s.Wm)(n,{label:"Time",prop:"heure"}),(0,s.Wm)(n,{label:"Title",prop:"titre"}),(0,s.Wm)(n,{label:"Address",prop:"adresse"}),(0,s.Wm)(n,{label:"Description",prop:"motif"}),(0,s.Wm)(n,{align:"right"},{default:(0,s.w5)((e=>[(0,s.Wm)(l,{size:"small",type:"danger",onClick:t=>i.deleteLine(e.row.id)},{default:(0,s.w5)((()=>[(0,s.Uk)("Delete")])),_:2},1032,["onClick"]),(0,s.Wm)(l,{size:"small",onClick:t=>i.genererICS(e.row)},{default:(0,s.w5)((()=>[P,(0,s.Uk)(" Export ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])],64)}r(8858),r(1318),r(3228);var O={data(){return{allRdv:null,user:null}},computed:{},created(){this.rdvServices=new V},async mounted(){this.user=JSON.parse(localStorage.getItem("auth")),this.allRdv=await this.rdvServices.getAllRdv(this.user.id)},methods:{async edit(e){this.$router.push({name:"ModifierRdv",params:{id:e.id}})},genererICS(e){const t=this.formatDate(new Date),r=`BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:MattéoCorp/RDV APP/\nBEGIN:VEVENT\nUID:${this.generateUniqueId()}\nDTSTART;TZID=Europe/Paris:${this.concatDateAndTime(this.convertDateToICalFormat(e.date),this.convertTimeToICalFormat(e.heure))}\nDTSTAMP:${t}\nSUMMARY:${this.getTitre(e)}\nDESCRIPTION:${this.getMotif(e)}\nBEGIN:VALARM\nTRIGGER:-P1D\nDESCRIPTION:Rappel : ${this.getTitre(e)}\nACTION:DISPLAY\nEND:VALARM\nEND:VEVENT\nEND:VCALENDAR`,o=new Blob([r],{type:"text/calendar;charset=utf-8"}),s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download="rdv.ics",s.click()},concatDateAndTime(e,t){const r=`${e}T${t}`;return r},convertTimeToICalFormat(e){const t=e.split(":"),r=t[0],o=t[1],s=`${r}${o}00Z`;return s},pad(e){return e<10?"0"+e:e},convertDateToICalFormat(e){const t=e.split("-"),r=t[0],o=t[1],s=t[2],a=`${s}${o}${r}`;return a},generateUniqueId(){const e=(new Date).getTime().toString(16),t=Math.random().toString(16).substr(2,6),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})),o=e+"-"+t+"-"+r;return o},formatDate(e){const t=e=>e<10?"0"+e:e;return e.getUTCFullYear()+t(e.getUTCMonth()+1)+t(e.getUTCDate())+"T"+t(e.getUTCHours())+t(e.getUTCMinutes())+t(e.getUTCSeconds())+"Z"},getMotif(e){return e.motif},getTitre(e){return e.motif.substring(0,10)},getLocation(e){return e.adresse},async deleteLine(e){this.$confirm("Voulez-vous vraiment supprimer cet élément?","Confirmation",{confirmButtonText:"Confirmer",cancelButtonText:"Annuler",type:"warning"}).then((async()=>{await this.rdvServices.deleteLine(e).then((()=>{this.$message({message:"Supression terminé !",type:"success",duration:3e3,showClose:!0})})).catch((e=>{this.$message({message:"Erreur lors de la suppression du rendez-vous !",type:"warning",duration:3e3,showClose:!0}),console.error(e)})),this.allRdv=await this.rdvServices.getAllRdv(this.user.id)}))}}};const q=(0,u.Z)(O,[["render",M],["__scopeId","data-v-1266ca7f"]]);var N=q;const z={class:"login-container"};function L(e,t,r,o,a,i){const n=(0,s.up)("el-input"),l=(0,s.up)("el-form-item"),u=(0,s.up)("el-button"),d=(0,s.up)("el-form");return(0,s.wg)(),(0,s.iD)("div",z,[(0,s.Wm)(d,{model:a.loginForm,ref:"loginForm",rules:a.loginRules,"label-width":"80px"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{label:"Username",prop:"username"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:a.loginForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>a.loginForm.username=e),"auto-complete":"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(l,{label:"Password",prop:"password"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{type:"password",modelValue:a.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.loginForm.password=e),"auto-complete":"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{type:"primary",onClick:t[2]||(t[2]=e=>i.checkUser())},{default:(0,s.w5)((()=>[(0,s.Uk)("Login")])),_:1}),(0,s.Wm)(u,{type:"primary",onClick:t[3]||(t[3]=e=>i.goToRegister())},{default:(0,s.w5)((()=>[(0,s.Uk)("Registration")])),_:1})])),_:1})])),_:1},8,["model","rules"])])}var j=r(9564),Z=r.n(j);async function B(e,t){const r=new V,o=await r.checkUser(e);if(Z()(t)===o.password){const e=o;return e}return!1}var Y={data(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:"Veuillez entrer votre nom d'utilisateur",trigger:"blur"}],password:[{required:!0,message:"Veuillez entrer votre mot de passe",trigger:"blur"}]}}},created(){this.rdvServices=new V},methods:{async checkUser(){try{const e=await B(this.loginForm.username,this.loginForm.password);if(e){const t=(new Date).getTime()+36e5;localStorage.setItem("auth",JSON.stringify({username:e.login,id:e.id,expirationTime:t}));const r=localStorage.getItem("redirectRoute");this.$router.push(r||"/")}else this.$message.error("Vous n'avez pas l'autorisation !")}catch(e){e instanceof Error&&"Nom d'utilisateur ou mot de passe incorrect."===e.message&&(this.$message.error("Nom d'utilisateur ou mot de passe incorrect."),console.log(e))}},goToRegister(){this.$router.push("/register")}}};const G=(0,u.Z)(Y,[["render",L],["__scopeId","data-v-09b94ece"]]);var H=G;const J={class:"register-container"};function K(e,t,r,o,a,i){const n=(0,s.up)("el-input"),l=(0,s.up)("el-form-item"),u=(0,s.up)("el-button"),d=(0,s.up)("el-form");return(0,s.wg)(),(0,s.iD)("div",J,[(0,s.Wm)(d,{model:a.registerForm,ref:"registerForm",rules:a.registerRules,"label-width":"120px"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{label:"Username",prop:"login"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{modelValue:a.registerForm.login,"onUpdate:modelValue":t[0]||(t[0]=e=>a.registerForm.login=e),"auto-complete":"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(l,{label:"Password",prop:"password"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{type:"password",modelValue:a.registerForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.registerForm.password=e),"auto-complete":"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(l,{label:"Confirm Password",prop:"confirmPassword"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{type:"password",modelValue:a.registerForm.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>a.registerForm.confirmPassword=e),"auto-complete":"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{type:"primary",onClick:t[3]||(t[3]=e=>i.registerUser())},{default:(0,s.w5)((()=>[(0,s.Uk)("Register")])),_:1})])),_:1})])),_:1},8,["model","rules"])])}var Q={data(){return{registerForm:{login:"",password:"",confirmPassword:""},registerRules:{login:[{required:!0,message:"Please enter your username",trigger:"blur"}],password:[{required:!0,message:"Please enter your password",trigger:"blur"}],confirmPassword:[{required:!0,message:"Please confirm your password",trigger:"blur"},{validator:(e,t,r)=>{t!==this.registerForm.password?r(new Error("Passwords do not match")):r()},trigger:"blur"}]}}},created(){this.rdvServices=new V},methods:{async registerUser(){this.$refs.registerForm.validate((async e=>{if(!e)return this.$message.error("Please correct the errors in the form"),!1;try{const e=Z()(this.registerForm.password),t={login:this.registerForm.login,password:e};await this.rdvServices.register(t),this.$message.success("Registration successful!"),this.$router.push("/login")}catch(t){this.$message.error("Registration failed")}}))}}};const X=(0,u.Z)(Q,[["render",K],["__scopeId","data-v-403a0bac"]]);var ee=X;const te=[{path:"/login",component:H},{path:"/register",component:ee},{path:"/",component:N,meta:{requiresAuth:!0}},{path:"/ajouter",alias:"/modifier",name:"AjouterRdv",component:E,meta:{requiresAuth:!0}},{path:"/listeRdv",component:N,meta:{requiresAuth:!0}}],re=(0,v.p7)({history:(0,v.PO)(),routes:te});re.beforeEach((async(e,t,r)=>{if(e.matched.some((e=>e.meta.requiresAuth))){const t=JSON.parse(localStorage.getItem("auth"))||{};!t.username||t.expirationTime&&(new Date).getTime()>t.expirationTime?(localStorage.setItem("redirectRoute",e.fullPath),r("/login")):r()}else r()}));var oe=re,se=r(1546);r(4415);const ae=(0,o.ri)(h);ae.use(f.ZP),ae.use(oe),ae.use(se.Z),ae.component("InputText",g.Z),ae.component("InputNumber",w.Z),ae.mount("#app")}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(t,o,s,a){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],a=e[d][2];for(var n=!0,l=0;l<o.length;l++)(!1&a||i>=a)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(n=!1,a<i&&(i=a));if(n){e.splice(d--,1);var u=s();void 0!==u&&(t=u)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,s,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,a,i=o[0],n=o[1],l=o[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)r.o(n,s)&&(r.m[s]=n[s]);if(l)var d=l(r)}for(t&&t(o);u<i.length;u++)a=i[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},o=self["webpackChunkchoisis_ton_rdv"]=self["webpackChunkchoisis_ton_rdv"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[998],(function(){return r(1025)}));o=r.O(o)})();
//# sourceMappingURL=app.a20aeefd.js.map